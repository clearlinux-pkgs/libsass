From 38f4c3699d06b64128bebc7cf1e8b3125be74dc4 Mon Sep 17 00:00:00 2001
From: xzyfer <xzyfer@gmail.com>
Date: Wed, 4 Jul 2018 20:36:29 +1000
Subject: [PATCH] Fix CVE-2018-11696

Fix possible bug with handling empty reference combinators

An issue was discovered in LibSaas through 3.5.4. A NULL pointer dereference
was found in the function Sass::Inspect::operator which could be leveraged by
an attacker to cause a denial of service (application crash) or possibly have
unspecified other impact.

Taken from https://github.com/sass/libsass/pull/2687

---
 src/inspect.cpp | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/inspect.cpp b/src/inspect.cpp
index bd038922..b56fd89a 100644
--- a/src/inspect.cpp
+++ b/src/inspect.cpp
@@ -1042,7 +1042,7 @@ namespace Sass {
       case Complex_Selector::REFERENCE:
         append_mandatory_space();
         append_string("/");
-        c->reference()->perform(this);
+        if (c->reference()) c->reference()->perform(this);
         append_string("/");
         append_mandatory_space();
       break;
-- 
2.18.0

